合法设备id格式4位16进制串，如0000 F1C3 FFFF 531A等
设备订阅主题：/test/设备id/down （注意大小写均可） 用于接收下行指令
设备推送主题：/test/设备id/up 不订阅只发送，用于向上发送数据

数据格式：（HEX字节流）

设备上行
设备ID（2字节）采集数（有符号4字节16进制整数，原码表示）
例1
FF 33 00 00 00 34
即FF33这个设备采集到了52这个值
例2
A3 05 F3 41 23 01
即A305这个设备采集到了-213,835,007这个值

设备下行
设备ID（2字节）00
例FF 34 00
即向FF34发送代号为00指令
通讯之后，若设备在1分钟内通过上行主题返回 FF 34 00
则发送成功，否则重试
重试3次仍未回复则发送失败
成功失败需记录日志


用MQTTX测试
- MQTTX输入数据 -> EMQX转发给服务器 -> 服务器接收并存入influxDB
- 转发过程转发HEX字节流。

## 客户端设备
### 订阅
- 在`"/test/设备id/up"`发送数据。
- 在`"/test/设备id/down"`接收指令。

### 接受指令并执行
- 收到来自`"/test/设备id/down"`的指令后，
- 验证指令是否可行，
- 可行则执行指令，
- 不行则抛错。

## 服务器端
### 订阅
- 在`"/test/设备id/up"`接收数据。
- 在`"/test/设备id/down"`发送指令。

### 接收数据并验证
- 查询设备数据库是否存在匹配**主题**的设备，
    - 不存在，报错，
    - 存在，进入下一步。
- 验证是**返回信息**还是**收集信息**，
    - 如果是**收集信息**，将值存入`influxdb`，
    - 如果是**返回信息**，则验证是否与发送指令要求一致，
        - **不一致**
            - 查询重试次数，
                - 超过3次则失败，记入日志。
                - 不超过则+1，等一分钟，重试。
        - **一致**，则发送成功，记入日志。

### 连接与操作设备数据库
- 连接设备数据库
- [x] CRUD operation
- [x] data source abstraction
- [x] connection management

- 操作设备数据库
- [x] 查询有无指定数据
    - [x] 查询整张表数据并将每条记录构建成map，键为id
    - [x] 查找map中有无对应id
- [ ] 增加指定数据

## 数据库
### 设备数据库（mysql）
- [x] 设备id表

### 采集信息数据库（influxdb）
- [ ] 创建dao


## 指令
### 接收指令
### 发送指令

## 工程Q&As
- Q: 以`[]byte`的数据类型传递信息，那么程序应该用`[]byte`接收吗？还是直接使用`string`就可以了？  
    A: 一般为了直观，方便处理，使用目标数据类型（如`string`）就可以。`[]byte`类型接收到程序里依然是`[]byte`类型，接收后要对类型做转换处理，发送也是。
    一般先使用`Marshal/Unmarshal`将数据类型转换成`[]byte`或者目标类型，然后进行发送或处理。  
    
- Q：什么时候适合传入结构体的指针，什么时候适合传入结构体？
    A：传入结构体相当于复制一份并只在函数内修改，传入指针则能修改外部结构体。所以当需要直接修改、或者不想传入传出占大量内存的时候使用指针作为参数。

- Q：那么什么时候适合传出结构体指针呢？
    A：几乎所有时候。在函数内初始化结构体，存入内存，返回内存的地址。
